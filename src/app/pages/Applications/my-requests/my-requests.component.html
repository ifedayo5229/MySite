<section class="wrapper">

  <h2 class="title">
    <i class="material-icons">list_alt</i>
    My Requests
  </h2>

  <!-- Loading indicator -->
  <div *ngIf="loading" class="loading">
    <span class="spinner"></span> Loading requestsâ€¦
  </div>

  <!-- Empty state -->
  <div *ngIf="!loading && requests.length === 0" class="empty">
    <i class="material-icons">inbox</i>
    <p>No requests found.</p>
  </div>

  <!-- Requests grid -->
  <div class="grid" *ngIf="requests.length > 0">
    <article 
      class="card" 
      *ngFor="let r of requests" 
      [id]="'app-' + r.id"
      [class.highlighted]="r.id?.toString() === highlightedId">

      <!-- Status Badge -->
      <div class="status-badge" [ngClass]="badge(r.status)">
        <span>{{ r.status }}</span>
      </div>

      <!-- Header -->
      <header>
        <h3 [title]="r.applicationName">{{ r.applicationName }}</h3>
        <p class="subtitle">
          <i class="material-icons">apps</i>
          {{ r.applicationType }}
        </p>
      </header>

      <!-- Meta -->
      <div class="meta">
        <div class="meta-item">
          <i class="material-icons">location_on</i>
          <span>{{ r.locationName }}</span>
        </div>
        <div class="meta-item">
          <i class="material-icons">business</i>
          <span>{{ r.functionName }}</span>
        </div>
        <div class="meta-item">
          <i class="material-icons">calendar_today</i>
          <span>{{ r.requestDate | date:'mediumDate' }}</span>
        </div>
      </div>

      <!-- Explanation collapsible -->
      <details class="explanation">
        <summary>
          <i class="material-icons">expand_more</i>
          See explanation
        </summary>
        <p>{{ r.explanation }}</p>
      </details>

      <!-- Actions -->
      <div class="actions">
        <span class="action-link" (click)="viewDetails(r.id)">
          <i class="material-icons">visibility</i>
          View Details
        </span>
      </div>
    </article>
  </div>

</section>
